{"data":{"site":{"siteMetadata":{"title":"About web performance and sites with energy low.","author":"Dmitry Schegolihin"}},"markdownRemark":{"id":"c5fa6170-ee1c-58d2-9214-187a101a7665","excerpt":"In this tutorial we try send to   instance a test data via   protocol. I’m new to this   (Elastic Logstash Kibana) stack and many new…","html":"<p>In this tutorial we try send to <code class=\"language-text\">Logstash</code> instance a test data via <code class=\"language-text\">UDP</code> protocol. I’m new to this <code class=\"language-text\">ELK</code> (Elastic Logstash Kibana) stack and many new questions for me. The best varinat try in practice.</p>\n<p>In next we we will use the predefined <a href=\"https://github.com/deviantony/docker-elk\">ELK</a> images based on <code class=\"language-text\">Docker</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">git clone git@github.com:deviantony/docker-elk.git\ncd docker-elk &amp;&amp; docker-compose up --build -d</code></pre></div>\n<p>After up all <code class=\"language-text\">ELK</code> containers need check <code class=\"language-text\">Logstash</code> status. We will use nodejs script. You can edit the <code class=\"language-text\">Logstash</code> values for <code class=\"language-text\">host</code> and <code class=\"language-text\">port</code> as you need.</p>\n<p>Create file <code class=\"language-text\">send-message-to-logstash.js</code> with content:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/* globals require:true, console:true, process:true */</span>\n\n<span class=\"token comment\">// This script will send a message to a [logstash](http://logstash.net/)</span>\n<span class=\"token comment\">// server using the [TCP input](http://logstash.net/docs/1.1.13/inputs/tcp)</span>\n<span class=\"token comment\">// and then quit. If there is no listener, it will just quit.</span>\n\n<span class=\"token string\">'use strict'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> net <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'net'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> logHost <span class=\"token operator\">=</span> <span class=\"token string\">'127.0.0.1'</span>\n  <span class=\"token punctuation\">,</span> logPort <span class=\"token operator\">=</span> <span class=\"token number\">5000</span>\n  <span class=\"token punctuation\">,</span> sender <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'os'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hostname</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> conn <span class=\"token operator\">=</span> net<span class=\"token punctuation\">.</span><span class=\"token function\">createConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> host<span class=\"token punctuation\">:</span> logHost<span class=\"token punctuation\">,</span> port<span class=\"token punctuation\">:</span> logPort <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> message <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'@tags'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'nodejs'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">,</span> <span class=\"token string\">'@message'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'tcp test '</span>\n  <span class=\"token punctuation\">,</span> <span class=\"token string\">'@fields'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'sender'</span><span class=\"token punctuation\">:</span> sender<span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  conn<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  process<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'error'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  process<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Execution this script:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">node send-message-to-logstash.js</code></pre></div>\n<p>Now we can check Elastic indexies and see new <code class=\"language-text\">Logstash</code> index. For this porpose is cool extension <a href=\"https://github.com/mobz/elasticsearch-head\">Elastic Head</a> for Google Chrome.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/42e6b4c45a0d5a9cdcdd5efc81aaac9e/ff28e/elastic-logstash-index.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 37.93436293436294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABLklEQVQY032Q60+CYBjF+f//klYfarnWtJWQYzkEK29x9cVQeAH1RbkI+l4CpbW28rezs/N8eLbzPBzP861WU1b6ujUdfai2A+cenM1hEK58CAEA47EKwKtpXOn6ZemmeeE492EYlHDu3IcLf2KvhcHiqWc0X7SHrvrYn326KEKrOEkwwfme5HtW7FntBd3lRSmOMUYpLT3NcrE/6Y2sqRMcDrhIdsrbUB5MvHDNKKEUf4scVcFlWbqJojRN0iybLZaOh2CA4m2MPG9pq7b27poDnCesgrLfcKqmSbLi+QHaoI7UFhVBlAVBapuWZdh6nMRZmpVF2F9wBoDS0AZuGqHtLX/d6NzcPTfKMAVWdygWh4L9z/FmQjEmhNCqF60Lnh5xnp+HnVaqqQ61n+ELluS+zHaAyeEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Logstash index\"\n        title=\"\"\n        src=\"/static/42e6b4c45a0d5a9cdcdd5efc81aaac9e/fb8a0/elastic-logstash-index.png\"\n        srcset=\"/static/42e6b4c45a0d5a9cdcdd5efc81aaac9e/1a291/elastic-logstash-index.png 148w,\n/static/42e6b4c45a0d5a9cdcdd5efc81aaac9e/2bc4a/elastic-logstash-index.png 295w,\n/static/42e6b4c45a0d5a9cdcdd5efc81aaac9e/fb8a0/elastic-logstash-index.png 590w,\n/static/42e6b4c45a0d5a9cdcdd5efc81aaac9e/526de/elastic-logstash-index.png 885w,\n/static/42e6b4c45a0d5a9cdcdd5efc81aaac9e/fa2eb/elastic-logstash-index.png 1180w,\n/static/42e6b4c45a0d5a9cdcdd5efc81aaac9e/08f6a/elastic-logstash-index.png 1770w,\n/static/42e6b4c45a0d5a9cdcdd5efc81aaac9e/ff28e/elastic-logstash-index.png 2072w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Go to <code class=\"language-text\">Kibana</code> in browser with standard port <code class=\"language-text\">http://localhost:5601</code> and see detected the <code class=\"language-text\">Logstash</code> index:</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6e6fd7c12ac4821ced4e6b0b2fab47b6/8a4c9/kibana-detected-new-index.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 47.9050279329609%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAAA0UlEQVQoz6WQTWvDMAyG/f/P/Tu7j94HY7utLaRuZyW29eGonqekhOUw1sAehJGwXn25U4iQUIRlptbaWvvahts97Z9f35WSv1y7rvPeD8OgquMKC28L6y8Xji+5eyvxQsQxRgCw10ZYi03TFswXZp4THDMZlp2JA/QW5ZyLSHuEVXE4Y3r4jBATjYosJOUPWdFK0yo6ia2VzRGv4Xw6Bn+GlADRtvz1SHZM0RuW8UcspVAP/vAhPVjtes/bOvbUqmqdbRvTwXDB+uPdNuPwH3wD0QlFbwEKp94AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Kibana detected logstash index\"\n        title=\"\"\n        src=\"/static/6e6fd7c12ac4821ced4e6b0b2fab47b6/fb8a0/kibana-detected-new-index.png\"\n        srcset=\"/static/6e6fd7c12ac4821ced4e6b0b2fab47b6/1a291/kibana-detected-new-index.png 148w,\n/static/6e6fd7c12ac4821ced4e6b0b2fab47b6/2bc4a/kibana-detected-new-index.png 295w,\n/static/6e6fd7c12ac4821ced4e6b0b2fab47b6/fb8a0/kibana-detected-new-index.png 590w,\n/static/6e6fd7c12ac4821ced4e6b0b2fab47b6/526de/kibana-detected-new-index.png 885w,\n/static/6e6fd7c12ac4821ced4e6b0b2fab47b6/fa2eb/kibana-detected-new-index.png 1180w,\n/static/6e6fd7c12ac4821ced4e6b0b2fab47b6/08f6a/kibana-detected-new-index.png 1770w,\n/static/6e6fd7c12ac4821ced4e6b0b2fab47b6/8a4c9/kibana-detected-new-index.png 2864w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>After configure <code class=\"language-text\">Logstash</code> index we can use the <code class=\"language-text\">Discover</code> tab for visualize search:</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a576fb9911501b49f19deaff30ee8e2d/70380/kibana-discover.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 46.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAABRElEQVQoz52QsUoDQRCGtzOxCZJWfA0fRIygVmqpkmgKC0GwE7RRsBdF9BGMWChoEwgEIghKDF6CFqeS3N7O7t3srnN7ORC0EL9i2R3+f2b+ZZObB8XFrZv7J2ttHEcAIKWMHHGGUkpkBJxLELeP3u5lg40v7xSWttcPj/dPzveOzl56r0ZrUpOZupA6dCQ+EFRP24Wg3rlgEwsbY7Nrp7Vrr9tte70QwP7AGENn68NXGr9VNSvOVwtz1Vq9aeNkFKImqdY6NRhHjEi3TjBIzGZY1IhsZGolX6pc1JsmUpQnTYiIEiDs91Frip4sDYD0JRnSaVhuenV0pkKTUclBEFCJ/DQXOH/rPH/6Pg8C4UJzl59zTndSRioamq8aLauR2tPCw0gYWyFMyK3b/1cSc75Uvnto04OS2r+R/gjLlcr/MKd8AdTQ4jMyziXTAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Kibana the Discover tab\"\n        title=\"\"\n        src=\"/static/a576fb9911501b49f19deaff30ee8e2d/fb8a0/kibana-discover.png\"\n        srcset=\"/static/a576fb9911501b49f19deaff30ee8e2d/1a291/kibana-discover.png 148w,\n/static/a576fb9911501b49f19deaff30ee8e2d/2bc4a/kibana-discover.png 295w,\n/static/a576fb9911501b49f19deaff30ee8e2d/fb8a0/kibana-discover.png 590w,\n/static/a576fb9911501b49f19deaff30ee8e2d/526de/kibana-discover.png 885w,\n/static/a576fb9911501b49f19deaff30ee8e2d/fa2eb/kibana-discover.png 1180w,\n/static/a576fb9911501b49f19deaff30ee8e2d/08f6a/kibana-discover.png 1770w,\n/static/a576fb9911501b49f19deaff30ee8e2d/70380/kibana-discover.png 3264w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Next need configure with <code class=\"language-text\">UDP</code> transport plugin <a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-inputs-udp.html\">https://www.elastic.co/guide/en/logstash/current/plugins-inputs-udp.html</a>\nTo be continue…</p>","frontmatter":{"title":"ELK stack setup via udp protocol","date":"November 10, 2018"}}},"pageContext":{"slug":"/elk-stack-setup/","previous":{"fields":{"slug":"/disk-usage-analisis/"},"frontmatter":{"title":"Check disk space usage on linux with Ncdu"}},"next":{"fields":{"slug":"/redis-clear/"},"frontmatter":{"title":"Clear redis cache from you docker container"}}}}